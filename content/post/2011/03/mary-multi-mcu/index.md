---
title: "超小型ARMマイコン基板でマルチMCUを試す"
date: 2011-03-21
slug: "mary-multi-mcu"
categories: 
  - "electronics"
---

昨日に引き続きトラ技増刊の付録である超小型ARMマイコン基板（MARY）を触っています。  
MARYシステムの特徴である、複数のMCUの協調を行ってみました。  
MB基板にもプログラムを書き込むためにもう１枚のMB基板をUSBに接続するとCOM6として認識されました。これで書き込みます。ちなみにもう１枚はCOM5で認識されています。  
[CQ出版の特設ページ](http://toragi.cqpub.co.jp/tabid/412/Default.aspx)からダウンロードしたサンプルプログラムを動かしてみたところ、見事に同期しています。

これを実験するためにはMB基板の接続ケーブルが必要になります。私は事前に[マルツパーツ館](http://www.marutsu.co.jp/user/tr_kikaku1101.php)から購入していたので良いのですが、雑誌を買ったたけではすぐ試すことができません。雑誌の付録にMB基板直結ケーブルが１本入っているとすぐ楽しめるのですが。

このサンプルプログラムを参考にして、MB基板間で通信を行い、交互に点滅するようにしてみました。

{{< youtube MCxlttvDDqc >}}

  
さきほどのサンプルプログラムはtickを同期することで、各MB基板が同じタイミングで同じ動作になるようにしていますが、今回はtickは使わないでON/OFFのデータ(uint32)を送受して制御してみました。  
1wireで行われている通信プロトコルはAPIでラッピングされているので、思ったより簡単に使えます。

プログラムが動くことは確認できましたが、せっかくOB基板を持っているので、そちらにデバック情報を表示させてみました。

{{< youtube IyOuLI_HOvA >}}

これもAPIが準備されているのでprintf感覚で手軽に文字が表示できます。OLEDはデバッグにも活躍しそうです。

MARYシステムは手軽に使えるということが分かったので、XB基板を追加注文してしまいました。実はXBeeを使うのは目的ではなく、microSDカードとシリアルUSBが使えるとおもしろいかなと。到着が楽しみです。
