---
title: "ESP32でミニカーを作る #7 マイクロマウスに挑戦（おおたfab 電子工作初心者勉強会）"
draft: true
---

[おおたfab](https://ot-fb.com/event)さんでは電子工作初心者勉強会を定期的に開催しています。

[前回](https://kanpapa.com/2025/08/otafab-esp32-minicar5.html)はESP32マイコンで動くミニカーで前後左右回転などの動きを実装しました。今回は超音波センサーだけでどこまでマイクロマウスに迫ることができるか試してみます。初心者勉強会なのでGoogleのGeminiにプログラムを助けてもらいながら進めます。

## Geminiはソースコードをどこまで理解できるのか

今回はGeminiの助けを借りてプログラミングしていきます。まずはこれまで作成したプログラムを読み込ませて、仕様書をまとめてもらうことでソースコードだけでどこまで理解しているのかをためしてみます。プロンプトはシンプルなものにしました。

「このプログラムの仕様書を作成してください。」

表示された結果は素晴らしいものでソースコードのコメントも使って分析しているようです。その一部を示します。

```
ご提供いただいたソースコード（20250830_esp32_mouse2_move_to_4_direction_and_rolate.ino）に基づき、このロボット制御システムの仕様書を作成しました。

ESP32C6 搭載マウスロボット制御システム仕様書

1. 概要
本システムは、Seeed Studio XIAO ESP32C6をメインコントローラとした移動ロボットのファームウェアである。2つのDCモーターによる移動制御、超音波センサーによる距離計測、およびOLEDディスプレイへのステータス表示機能を有する 。

作成日: 2025/08/30 
ターゲットボード: XIAO ESP32C6
   :
   :
```

全文はGitHubに登録しました。

## OLEDに表示する内容を変更する

次に簡単な修正をお願いしてみました。OLEDには現在超音波センサーの計測結果が表示されています。これに加えて現在の移動方向を表示してもらうように指示してみました。プロンプトは以下の通りです。

「ロボットがどの動きを行っているのかOLEDに英語で表示するようにプログラムを修正してください。」

「距離表示を一旦コメントにしておいて、動きの表示を最大限大きな文字で表示するようにしてください。動作時間は1000ミリ秒のところをすべて5000ミリ秒にしてください。」

## ロボットの動きを指定してみる

次にもう少し複雑な変更をお願いしてみました。ロボットが正方形を描

「今の状態はいろいろな動きをするようにしていますが、これを一旦コメントアウトしておいて、右方向に90度を４回曲がるプログラム修正してください。」

「回転させる時間を400ミリ秒に修正し、それぞれの回転の間に1000ミリ秒直進の動作を追加して四角形を描くように移動させてください。」

「回転の時間を600ミリ秒に修正し、直進動作を2000ミリ秒に修正してください。」

## 袋小路から脱出できるようにしてみる

「600ミリ秒で90度回転するようになりました。このロボットで迷路を脱出するアルゴリズムを実装してください。」

「距離測定後、2秒間前進してしまいます。走行中も常に距離測定を行い、常に衝突判定をしてください。」

「動かしました。回転動作の際に、ほぼ180度回転して後ろに戻ってしまいます。修正してください。」

## まとめ

「無事想定通りの動作になりました。本日の検討内容を要約してください。」

「このロボットを使って迷路以外の面白そうな動作はできますか？」
